<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renewable vs Non-Renewable Energy</title>
    <link rel="stylesheet" href="css/style.css"> <!-- Link to CSS -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
    <header>
        <h1>Renewable vs Non-Renewable Energy in Malaysia</h1>
    </header>

    <main>
        <!-- 1. Stacked Bar Chart: Renewable vs Non-Renewable Energy -->
        <div class="chart-container">
            <h2>Stacked Bar Chart: Energy Production</h2>
            <div id="chart1"></div>
        </div>
    </main>

    <script>
        // Load Renewable Energy Data
        const renewableData = fetch('data/renewable_energy_generation.json')
            .then(response => response.json());

        // Load Non-Renewable Energy Data
        const nonRenewableData = fetch('data/non_renewable_energy_generation.json')
            .then(response => response.json());

        // Create Stacked Bar Chart after data is loaded
        Promise.all([renewableData, nonRenewableData]).then(values => {
            const [renewable, nonRenewable] = values;

            // Combine data for stacked bar chart
            const combinedData = renewable.map(item => ({
                Year: item.Year,
                Generation: item.Generation,
                Type: 'Renewable',
                Technology: item.Technology
            })).concat(nonRenewable.map(item => ({
                Year: item.Year,
                Generation: item.Generation,
                Type: 'Non-Renewable',
                Technology: item.Technology
            })));

            // Vega-Lite Specification for Stacked Bar Chart
            const stackedBarChart = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "width": 900, // Increased width
                "height": 500, // Increased height
                "padding": 10, // Add padding around the chart
                "data": {
                    "values": combinedData
                },
                "mark": "bar",
                "encoding": {
                    "x": {
                        "field": "Year",
                        "type": "ordinal",
                        "axis": {
                            "labelAngle": 0, // Keep labels horizontal
                            "labelPadding": 10 // Add padding between labels and the axis
                        }
                    },
                    "y": {
                        "field": "Generation",
                        "type": "quantitative",
                        "aggregate": "sum",
                        "title": "Energy Generation (GWh)"
                    },
                    "color": {
                        "field": "Type",
                        "type": "nominal",
                        "scale": {
                            "domain": ["Renewable", "Non-Renewable"],
                            "range": ["#76c7c0", "#e05e2b"] // Colors for renewable and non-renewable
                        }
                    },
                    "tooltip": [
                        {"field": "Year", "type": "ordinal"},
                        {"field": "Generation", "type": "quantitative"},
                        {"field": "Type", "type": "nominal"}
                    ]
                },
                "config": {
                    "view": {
                        "stroke": "transparent" // Remove border
                    },
                    "axis": {
                        "labelFontSize": 12, // Set label font size
                        "titleFontSize": 14 // Set title font size
                    }
                }
            };


            // Render the chart
            vegaEmbed('#chart1', stackedBarChart);
        });
    </script>
</body>
</html>
